#Shows the Loan Default values 
df['default_flag'].value_counts().plot(kind='bar')
plt.title("Loan Default Distribution")
plt.xticks([0,1], ['Non-Default', 'Default'], rotation=0)
plt.show()

# Select numeric columns
numeric_df = df.select_dtypes(include=['float64', 'int64'])

# Correlation matrix
corr_matrix = numeric_df.corr()

# Shows the correaltion between the values
plt.figure(figsize=(10,8))
sns.heatmap(corr_matrix, cmap="coolwarm", center=0)
plt.title("Correlation Heatmap")
plt.show()

#Creating the correlation with default values
corr_with_default = corr_matrix['default_flag'].sort_values(ascending=False)
corr_with_default

#Shows the correlation by default values
corr_with_default.drop('default_flag').plot(kind='barh')
plt.title("Correlation with Default Flag")
plt.show()

#Shows the fico band by default values
fico_summary['default_rate'].plot(kind='bar')
plt.title("Default Rate by FICO Band")
plt.show()

#Created the profit summary data frame
profit_summary = df.groupby('grade').agg(
    total_interest=('total_rec_int', 'sum'),
    total_principal_loss=('principal_loss', 'sum')
)

#added the net profit column to the profit summary data frame
profit_summary['net_profit'] = (
    profit_summary['total_interest'] - 
    profit_summary['total_principal_loss']
)
profit_summary

#Calculated the risk return
risk_return = df.groupby('grade').agg(
    default_rate=('default_flag', 'mean'),
    net_profit=('principal_loss', 'sum')
)

#Shows the Risk VS Profit by Grade
plt.scatter(
    grade_summary['default_rate'],
    profit_summary['net_profit']
)
plt.xlabel("Default Rate")
plt.ylabel("Net Profit")
plt.title("Risk vs Profit by Grade")
plt.show()
